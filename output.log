INFO 08-28 01:42:24 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='/data/DeepLearning/LLM/models/Llama/Llama-3-8B-Instruct/', speculative_config=None, tokenizer='/data/DeepLearning/LLM/models/Llama/Llama-3-8B-Instruct/', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 08-28 01:42:24 utils.py:608] Found nccl from library /home/lym/.config/vllm/nccl/cu12/libnccl.so.2.18.1
INFO 08-28 01:42:25 selector.py:77] Cannot use FlashAttention backend because the flash_attn package is not found. Please install it for better performance.
INFO 08-28 01:42:25 selector.py:33] Using XFormers backend.
INFO 08-28 01:42:32 model_runner.py:173] Loading model weights took 14.9595 GB
INFO 08-28 01:42:34 gpu_executor.py:119] # GPU blocks: 536, # CPU blocks: 2048
INFO 08-28 01:42:35 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-28 01:42:35 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-28 01:42:41 model_runner.py:1057] Graph capturing finished in 6 secs.
INFO 08-28 01:42:41 llm_engine.py:98] Initializing an LLM engine (v0.4.1) with config: model='/data/DeepLearning/LLM/models/Llama/Llama-3-8B-Instruct/', speculative_config=None, tokenizer='/data/DeepLearning/LLM/models/Llama/Llama-3-8B-Instruct/', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), seed=0)
INFO 08-28 01:42:44 model_runner.py:173] Loading model weights took 14.9575 GB
INFO 08-28 01:42:46 gpu_executor.py:119] # GPU blocks: 750, # CPU blocks: 2048
INFO 08-28 01:42:47 model_runner.py:976] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 08-28 01:42:47 model_runner.py:980] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 08-28 01:42:53 model_runner.py:1057] Graph capturing finished in 5 secs.
INFO 08-28 01:42:53 block_manager_v1.py:235] Automatic prefix caching is enabled.
Results without `enable_prefix_caching`
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: Hello, my name is", Generated text: ' [Your Name], and I am the Principal of [Your School Name]. I'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The president of the United States is", Generated text: ' a woman, and she is a former teacher. She is a woman of color'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The capital of France is", Generated text: ' Paris. The candidate has a strong background in math education, and we are excited'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The future of AI is", Generated text: " bright, and the future of education is even brighter. The candidate's experience in"
--------------------------------------------------------------------------------
Results with `enable_prefix_caching`
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: Hello, my name is", Generated text: ' [Your Name], and I am the Principal of [Your School Name]. I'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The president of the United States is", Generated text: ' a woman, and she has a daughter who is a student at your school.'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The capital of France is", Generated text: ' Paris. The candidate has a strong background in math education and has experience working with'
Prompt: "You are an expert school principal, skilled in effectively managing faculty and staff. Draft 10-15 questions for a potential first grade Head Teacher for my K-12, all-girls', independent school that emphasizes community, joyful discovery, and life-long learning. The candidate is coming in for a first-round panel interview for a 8th grade Math teaching role. They have 5 years of previous teaching experience as an assistant teacher at a co-ed, public school with experience in middle school math teaching. Based on these information, fulfill the following paragraph: The future of AI is", Generated text: " bright, and the future of education is even brighter. The candidate's experience in"
--------------------------------------------------------------------------------
Generated answers are the same: False
duration_regular: 0.6549530029296875
duration_cached: 1.1648240089416504
Speed up of cached generation compared to the regular is: 0.56
